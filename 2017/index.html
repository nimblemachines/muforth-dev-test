<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="copyright" content="All content on muforth.dev is copyrighted. All rights are reserved." />
<meta name="keywords" content="2017, journal, blog" />
<meta name="robots" content="noindex,nofollow" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/-/screen.css" type="text/css" />
<link rel="icon" href="/-/9s08_hc595_150x150.jpg" type="image/jpeg" />
<link rel="canonical" href="https://www.muforth.dev/2017/" />
<title>2017 journal &ndash; muforth</title>
</head>
<body>

<div id="header">
<h1>2017 journal</h1>
<hr />
</div>

<div id="content">
<h3 id="may-01-14:00"><a href="#may-01-14:00">2017 May 01 14:00</a></h3>
<p>I&rsquo;ve written a <a href="/threaded-code/">tutorial on threaded code implementations</a> and also an exploration of the <a href="/call-versus-branch-and-link/">difference between call and branch-and-link instructions</a>, and how that difference relates to threaded code.</p>
<p>Enjoy reading!</p>
<hr />
<h3 id="april-11-00:17"><a href="#april-11-00:17">2017 April 11 00:17</a></h3>
<h4 id="why-am-i-excited-about-risc-v"><a href="#why-am-i-excited-about-risc-v">Why am I excited about RISC-V?</a></h4>
<p>I just posted a response on GitHub to the question &ldquo;Is RISC-V the bee&rsquo;s knees?&rdquo; and thought I should re-post it here.</p>
<p>I kinda feel the way I felt back in the 80s and early 90s when ARM was the underdog. They had a new, fresh design, a small-is-beautiful approach, and a sense of openness. (I have an ARM Assembler Cookbook that has some amazing ideas and code in it &ndash; circa 1993 or so.) Since then ARM have become much more closed and proprietary. Their clean, tiny core has grown an instruction set that rivals x86 in its complexity. And it&rsquo;s only getting worse with their move to 64 bits.</p>
<p><a href="https://riscv.org/">RISC-V</a> appeals to me in the same way that ARM did in those early days, and that Lua always has. I&rsquo;m <a href="https://www.nimblemachines.com/lua-programming-language/">on record celebrating Lua&rsquo;s parsimony</a> in an era of profligacy. RISC-V has the same sense of parsimony.</p>
<p>Having written a bunch of assemblers and disassemblers (and simple compilers too), I care about instruction sets. RISC-V really hits a sweet spot. The design is impeccable; and the encoding rather clever. I especially appreciate that the Compressed instructions are disjoint from the &ldquo;standard&rdquo; set &ndash; not some tacked-on after-thought that requires a new mode (Thumb, anyone?) and lots of annoyance and complexity for the compiler and OS people.</p>
<p>I also think it has <em>legs</em>. I really hope that SiFive make a big splash, and I&rsquo;m trying to help out in my small way by making tools that might be useful to people on this new cutting edge &ndash; people who are exploring the architecture and bringing up new systems.</p>
<p>I knew ARM was going to succeed. I should have bought their stock! But success has ruined them, in a way. Yes, their CoreSight Debug stuff is cool and well-designed, but Thumb2 is so hairy that I never finished my disassembler, and never even <em>started</em> the assembler. I didn&rsquo;t mean to, but I kind of gave up on Cortex-M.</p>
<p>And I totally buy the RISC-V propaganda about having a single instruction set for an entire SoC. Right now there might two or more for the core, another for the DSP, another for an &ldquo;embedded controller&rdquo;, etc. You have to have knowledge of each, toolchains for each, etc. It&rsquo;s a nightmare.</p>
<p>Having &ldquo;one instruction set&rdquo; to rule them all is a great idea. And one with built-in support for co-processors and instruction-set extensions! (Well, ARM had that too. The co-processor bit at least.)</p>
<p>Having a truly <em>free</em> instruction set that can be meaningfully used for both teaching and research is, frankly, amazing. And it&rsquo;s a nice one, too! An inspiration, even!</p>
<p>So, yes &ndash; I think RISC-V <em>is</em> the bee&rsquo;s knees. ;-)</p>
<p>As a side note: I was pretty excited about the MSP430 before I got excited about RISC-V. The MSP430 was probably the easiest instruction set to write an assembler and disassembler for, and because it&rsquo;s almost a PDP-11 &ndash; with the perfect mix of post-increment instructions and PC-as-a-general-register &ndash; writing an ITC Forth was not only totally trivial, but rivals native code in speed. (ITC NEXT is on par with doing a call and return, if not faster.)</p>
<p>Oddly, even though MSP430 is totally CISC, I was able to take the MSP430 kernel and meta-compiler and rewrite them for RISC-V in no time &ndash; a day or two maybe.</p>
<hr />
<h3 id="april-06-14:43"><a href="#april-06-14:43">2017 April 06 14:43</a></h3>
<h4 id="big-news-today"><a href="#big-news-today">Big news today!</a></h4>
<p>Two things:</p>
<ul>
<li>I just pushed the <a href="https://github.com/nimblemachines/muforth/commit/badd131afd1ec0078d129c5aad3c5ae96a0e81f8">2000th commit</a> to the <a href="https://github.com/nimblemachines/muforth">muforth GitHub repository</a>!</li>
<li>That commit includes support for remotely executing Forth code on a <a href="https://www.crowdsupply.com/sifive/hifive1">HiFive1</a>, using <a href="/getting-openocd-for-risc-v/">the RISC-V-aware port of <code>openocd</code></a> as a debug interface.</li>
</ul>
<p>What this <em>really</em> means is that muforth can now do all of the following:</p>
<ul>
<li>assemble and disassemble RISC-V code (RV32IM only; currently missing the A and C extensions);</li>
<li>compile assembler and Forth source code into a binary image;</li>
<li>transfer that image to the target (a HiFive1); and</li>
<li>interactively explore memory, and compose and execute code.</li>
</ul>
<p>See the full instructions for <a href="/getting-started-with-risc-v/">getting started with RISC-V</a>. I&rsquo;ll also keep up-to-date a page with the status of <a href="/risc-v-support/">RISC-V support</a> in muforth.</p>
<hr />
<h3 id="february-20-12:51"><a href="#february-20-12:51">2017 February 20 12:51</a></h3>
<h4 id="welcome-to-2017"><a href="#welcome-to-2017">Welcome to 2017!</a></h4>
<p>I won&rsquo;t say &ldquo;happy 2017&rdquo; because we now live in a strange time of hacked elections and dire futures. With luck the year will improve as it goes along &ndash; but events continue to suggest otherwise. I&rsquo;m going to try to stay busy working on muforth, regardless of the fraught political situation.</p>
<h4 id="msp430-updates"><a href="#msp430-updates">MSP430 updates</a></h4>
<p>I&rsquo;ve been working steadily on tweaks and fixes to the MSP430 target compiler. It is complete enough now to target compile Forth code, and do pretty featureful remote (tethered) execution on the target. There are a few things missing from the MSP430 Forth kernel &ndash; multiply and divide for example &ndash; so there is work to be done there.</p>
<p>And there is little to no documentation &ndash; other than the Git commit log (where I often wax prolix) &ndash; so getting started can be a challenge. Maybe I need a forum? But perhaps I should wait until there are more than two users... ;-)</p>
<h4 id="risc-v-arrives-in-silicon"><a href="#risc-v-arrives-in-silicon">RISC-V arrives in silicon!</a></h4>
<p>If you haven&rsquo;t been following the story, <a href="http://riscv.org/">RISC-V</a> (say &ldquo;risk five&rdquo;), a new computer architecture developed at UC Berkeley, aims to turn the world of computer architecture &ndash; and hopefully computing &ndash; on its head.</p>
<p>Originally developed for teaching and research, RISC-V is now taking on the world of commercial silicon. The founders of the project &ndash; Krste Asanovi&cacute;, Yunsup Lee, and Andrew Waterman &ndash; have spun off a company &ndash; <a href="https://www.sifive.com/">SiFive</a> &ndash; that aims to make developing <em>custom</em> RISC-V silicon easy and (relatively) inexpensive. (One neat thing about the architecture is its built-in support for instruction set extensions and custom co-processors.)</p>
<p>This talk by Krste Asanovi&cacute; is a great introduction to RISC-V:</p>
<div class="video-embed-container">
  <iframe width="640" height="360" src="https://www.youtube-nocookie.com/embed/QTYiH1Y5UV0" allowfullscreen></iframe>
</div>
<p>In order to get the ecosystem growing, SiFive have developed the first silicon &ndash; the <a href="https://dev.sifive.com/hifive1/freedom-e310-g000-manual/">FE310</a> &ndash; and a development board to exercise it &ndash; <a href="https://www.crowdsupply.com/sifive/hifive1">HiFive1</a>.</p>
<p><img src="/-/hifive1-board.jpg" alt="hifive1-board.jpg" title="hifive1-board.jpg" /></p>
<p>Previously it was possible to run RISC-V only in simulation (slow) or on an FGPA (somewhat faster). Now we can get an idea of what is possible in real silicon: the HiFive1 board sports a 32-bit RISC-V chip running at 320 MHz! (This is a 180nm design. They have another design in the pipeline with a more sophisticated core and targeting a much smaller process that will compete with ARM-based application processors.)</p>
<p>The HiFive1 is <a href="https://www.crowdsupply.com/sifive/hifive1">available from Crowd Supply</a>. Go grab one! Or five! I&rsquo;m going to get one, and I plan to get some kind of meta-compiled Forth running on it &ndash; with the help of muforth, of course. ;-) So I should be, in short order, committing an assembler and prototype meta-compiler for RISC-V!</p>
<p>And props to Crowd Supply for their <a href="https://www.crowdsupply.com/about#user-rights">Proclamation of User Rights</a>, which specifies that Creators can not trample on the rights of Users to explore, change, combine, criticize, and otherwise truly <em>own</em> the product, and further requires Creators to take care with respect to Users&rsquo; privacy and security.</p>
<p>Digital products are <em>hugely</em> problematic, <a href="https://www.eff.org/issues/right-to-repair">thanks to the DMCA</a>. Given the current state of law here in the USA, you don&rsquo;t truly own any product that you purchase (not license, but <em>purchase</em>) that contains software (or firmware). That software is the property of the manufacturer, and any efforts on your part to understand, modify, or fix it can mean breaking the law! Talk about a chilling effect!!</p>
<p>Forcing Creators (who use the Crowd Supply platform) to guarantee the freedom of Users to truly own the products they purchase is a <em>huge</em> win for Users. Bravo.</p>
<p>The <a href="https://www.eff.org/">Electronic Frontier Foundation (EFF)</a> is also <a href="https://www.eff.org/issues/right-to-repair">working hard on this issue</a>.</p>
<h4 id="web-site-update"><a href="#web-site-update">Web site update</a></h4>
<p>This site started out as a clone of <a href="http://www.nimblemachines.com/">Nimble Machines</a> and inherited all of its problems &ndash; chiefly, the lack of readability. Try as I might to choose attractive and interesting fonts, the sites remained difficult to read on-screen.</p>
<p>I recently spent several hours digging through <a href="https://fonts.google.com/">Google Fonts</a> &ndash; and what a load of dreck to search through! I almost gave up in despair. I kept finding fonts I liked, but somehow every combination I tried looked terrible.</p>
<p>The chief obstacle was finding a readable <em>body font</em>. I used the <a href="https://www.theguardian.com/">Guardian newspaper</a> as my model. A big part of the personality of the Guardian is the custom typeface, which is also supremely readable. I wanted to find something similar. <a href="https://fonts.google.com/specimen/Merriweather">Merriweather</a> seemed like a possibility, but it looked terrible when I tried using it. The available weights were either too light or dark, and it didn&rsquo;t resonate with any of the sans-serif fonts I wanted to use for headings.</p>
<p>I finally settled on a trio of fonts that seem to work well together. The body font is <a href="https://fonts.google.com/specimen/Droid+Serif">Droid Serif</a>; the title and heading font is <a href="https://fonts.google.com/specimen/Fira+Sans">Fira Sans</a> (commissioned by Mozilla for Firefox OS); and the monospace font used for code and Forth word names is <a href="https://fonts.google.com/specimen/Fira+Mono">Fira Mono</a> (also from Firefox OS).</p>
<p>I&rsquo;m going to leave the fonts alone, for now, though I may still tweak the (mostly non-existent) color scheme.</p>
<p>This minor &ldquo;redesign&rdquo; may show up on <a href="http://www.nimblemachines.com/">Nimble Machines</a> as well... ;-)</p>
<p>I&rsquo;ve also removed pages that were essentially copies of content from Nimble Machines. I want the pages here to be truly muforth-specific, and I plan to &ldquo;cross-link&rdquo; to pages on NM rather than have copies here. I feel like that is a cleaner solution.</p>
<hr />
<p>Read the <a href="/2016/">2016 journal</a>.</p>

</div>

<div id="footer">
<hr />
<a href="mailto:%77%65%62%68%61%6d%73%74%65%72%40%6e%69%6d%62%6c%65%6d%61%63%68%69%6e%65%73%2e%63%6f%6d?subject=%5bmuforth%5d%202017%20journal">Send feedback</a> on this page (last edited 2017 May 01 14:00)<br />
Browse <a href="/all-pages/">all pages</a>, or return <a href="/">home</a><br />
<a href="https://twitter.com/share?url=https%3a%2f%2fwww.muforth.dev%2f2017%2f&text=Say%20something%20nice!">Tweet</a> this page, or follow <a href="https://twitter.com/muforth">@muforth</a>
</div>

</body>
</html>
